=== no classes
def foo() -> int:
    return 1
---
root = null
---

=== single class no base
class Foo:
    def __init__(self) -> None:
        pass
---
root = null
ancestors.Foo.length = 0
---

=== single inheritance chain
class Node:
    def __init__(self) -> None:
        pass
class Expr(Node):
    def __init__(self) -> None:
        pass
class BinOp(Expr):
    def __init__(self) -> None:
        pass
---
root = Node
ancestors.Node.length = 0
ancestors.Expr.0 = Node
ancestors.BinOp.0 = Expr
---

=== hierarchy root detected
class Node:
    def __init__(self) -> None:
        pass
class Leaf(Node):
    def __init__(self) -> None:
        pass
---
root = Node
---

=== node types includes root and subclasses
class Node:
    def __init__(self) -> None:
        pass
class Expr(Node):
    def __init__(self) -> None:
        pass
class Stmt(Node):
    def __init__(self) -> None:
        pass
---
node_types.length = 3
---

=== no root when no inheritance
class Foo:
    def __init__(self) -> None:
        pass
class Bar:
    def __init__(self) -> None:
        pass
---
root = null
node_types.length = 0
---

=== exception subclass direct
class MyError(Exception):
    def __init__(self, msg: str) -> None:
        self.msg = msg
---
exception_types.length = 1
exception_types.0 = MyError
---

=== exception subclass transitive
class AppError(Exception):
    def __init__(self, msg: str) -> None:
        self.msg = msg
class ParseError(AppError):
    def __init__(self, msg: str) -> None:
        self.msg = msg
---
exception_types.length = 2
---

=== exception not in node types
class Node:
    def __init__(self) -> None:
        pass
class Leaf(Node):
    def __init__(self) -> None:
        pass
class MyError(Exception):
    def __init__(self, msg: str) -> None:
        self.msg = msg
---
root = Node
node_types.length = 2
exception_types.length = 1
exception_types.0 = MyError
---

=== wide hierarchy multiple children
class Node:
    def __init__(self) -> None:
        pass
class Add(Node):
    def __init__(self) -> None:
        pass
class Sub(Node):
    def __init__(self) -> None:
        pass
class Mul(Node):
    def __init__(self) -> None:
        pass
---
root = Node
node_types.length = 4
---

=== deep hierarchy three levels
class Node:
    def __init__(self) -> None:
        pass
class Expr(Node):
    def __init__(self) -> None:
        pass
class BinOp(Expr):
    def __init__(self) -> None:
        pass
---
root = Node
node_types.length = 3
ancestors.BinOp.0 = Expr
---

=== standalone class not a node type
class Node:
    def __init__(self) -> None:
        pass
class Leaf(Node):
    def __init__(self) -> None:
        pass
class Unrelated:
    def __init__(self) -> None:
        pass
---
root = Node
node_types.length = 2
---

=== class with exception marker
class AppError(Exception):
    def __init__(self, msg: str) -> None:
        self.msg = msg
---
exception_types.0 = AppError
root = null
---

=== mixed hierarchy and exceptions
class Node:
    def __init__(self) -> None:
        pass
class Expr(Node):
    def __init__(self) -> None:
        pass
class Stmt(Node):
    def __init__(self) -> None:
        pass
class CompileError(Exception):
    def __init__(self, msg: str) -> None:
        self.msg = msg
---
root = Node
node_types.length = 3
exception_types.length = 1
exception_types.0 = CompileError
---

=== no hierarchy root multiple roots
class A:
    def __init__(self) -> None:
        pass
class B:
    def __init__(self) -> None:
        pass
class ChildA(A):
    def __init__(self) -> None:
        pass
class ChildB(B):
    def __init__(self) -> None:
        pass
---
root = null
---

=== dataclass in hierarchy
from dataclasses import dataclass
class Node:
    def __init__(self) -> None:
        pass
@dataclass
class Leaf(Node):
    value: int
---
root = Node
node_types.length = 2
---

=== ancestors direct base only
class Base:
    def __init__(self) -> None:
        pass
class Mid(Base):
    def __init__(self) -> None:
        pass
class Leaf(Mid):
    def __init__(self) -> None:
        pass
---
ancestors.Leaf.length = 1
ancestors.Leaf.0 = Mid
ancestors.Mid.length = 1
ancestors.Mid.0 = Base
ancestors.Base.length = 0
---

=== error unknown base class
class Foo(Bar):
    def __init__(self) -> None:
        pass
---
error: not defined
---

=== error self inheritance
class A(A):
    def __init__(self) -> None:
        pass
---
error: cycle in inheritance
---

=== error inheritance cycle two classes
class A(B):
    def __init__(self) -> None:
        pass
class B(A):
    def __init__(self) -> None:
        pass
---
error: cycle in inheritance
---

=== error inheritance cycle three classes
class A(C):
    def __init__(self) -> None:
        pass
class B(A):
    def __init__(self) -> None:
        pass
class C(B):
    def __init__(self) -> None:
        pass
---
error: cycle in inheritance
---

=== multiple roots node types empty
class A:
    def __init__(self) -> None:
        pass
class B:
    def __init__(self) -> None:
        pass
class ChildA(A):
    def __init__(self) -> None:
        pass
class ChildB(B):
    def __init__(self) -> None:
        pass
---
root = null
node_types.length = 0
ancestors.ChildA.0 = A
ancestors.ChildB.0 = B
---

=== exception hierarchy no root
class AppError(Exception):
    def __init__(self, msg: str) -> None:
        self.msg = msg
class ParseError(AppError):
    def __init__(self, msg: str) -> None:
        self.msg = msg
---
root = null
node_types.length = 0
exception_types.length = 2
---

=== deep hierarchy four levels
class Node:
    def __init__(self) -> None:
        pass
class Expr(Node):
    def __init__(self) -> None:
        pass
class BinOp(Expr):
    def __init__(self) -> None:
        pass
class Add(BinOp):
    def __init__(self) -> None:
        pass
---
root = Node
node_types.length = 4
ancestors.Add.0 = BinOp
ancestors.BinOp.0 = Expr
ancestors.Expr.0 = Node
ancestors.Node.length = 0
---
