=== import sys allowed
import sys
def f() -> str:
    return sys.argv[0]
---
ok
---

=== from typing import Callable allowed
from typing import Callable
def f(fn: Callable[[int], int]) -> int:
    return fn(1)
---
ok
---

=== from typing import Optional allowed
from typing import Optional
def f(x: Optional[int]) -> int:
    if x is None:
        return 0
    return x
---
ok
---

=== from typing import Union allowed
from typing import Union
def f(x: Union[int, str]) -> str:
    return str(x)
---
ok
---

=== from typing import List allowed
from typing import List
def f(xs: List[int]) -> int:
    return len(xs)
---
ok
---

=== from typing import Dict allowed
from typing import Dict
def f(d: Dict[str, int]) -> int:
    return len(d)
---
ok
---

=== from typing import Set allowed
from typing import Set
def f(s: Set[int]) -> int:
    return len(s)
---
ok
---

=== from typing import Tuple allowed
from typing import Tuple
def f(t: Tuple[int, str]) -> int:
    return t[0]
---
ok
---

=== from typing import multiple imports allowed
from typing import Callable, Optional, Union, List
def f(x: Optional[int]) -> int:
    return x or 0
---
ok
---

=== from dataclasses import dataclass allowed
from dataclasses import dataclass
@dataclass
class Point:
    x: int
    y: int
---
ok
---

=== from dataclasses import field allowed
from dataclasses import dataclass, field
@dataclass
class Point:
    x: int
    y: int = 0
---
ok
---

=== from collections.abc import Iterator allowed
from collections.abc import Iterator
def f(it: Iterator[int]) -> int:
    return 0
---
ok
---

=== from collections.abc import Iterable allowed
from collections.abc import Iterable
def f(it: Iterable[int]) -> int:
    return 0
---
ok
---

=== from collections.abc import Sequence allowed
from collections.abc import Sequence
def f(s: Sequence[int]) -> int:
    return len(s)
---
ok
---

=== from collections.abc import Mapping allowed
from collections.abc import Mapping
def f(m: Mapping[str, int]) -> int:
    return len(m)
---
ok
---

=== from __future__ import annotations allowed
from __future__ import annotations
def f(x: int) -> int:
    return x
---
ok
---

=== relative import allowed
from . import module
---
ok
---

=== relative import from submodule allowed
from .sub import thing
---
ok
---

=== import os allowed
import os
def f() -> str | None:
    return os.getenv("HOME")
---
ok
---

=== import json not allowed
import json
def f(s: str) -> object:
    return json.loads(s)
---
error: import
---

=== import re allowed
import re
def f(s: str) -> bool:
    return re.match("a", s) is not None
---
ok
---

=== import math not allowed
import math
def f(x: float) -> float:
    return math.sqrt(x)
---
error: import
---

=== import random not allowed
import random
def f() -> int:
    return random.randint(0, 10)
---
error: import
---

=== import collections not allowed
import collections
def f() -> object:
    return collections.Counter()
---
error: import
---

=== from os import path not allowed
from os import path
def f(p: str) -> str:
    return path.basename(p)
---
error: import
---

=== from json import loads not allowed
from json import loads
def f(s: str) -> object:
    return loads(s)
---
error: import
---

=== from re import match not allowed
from re import match
def f(s: str) -> bool:
    return match("a", s) is not None
---
error: import
---

=== import numpy not allowed
import numpy
def f() -> object:
    return numpy.array([1, 2, 3])
---
error: import
---

=== import requests not allowed
import requests
def f(url: str) -> object:
    return requests.get(url)
---
error: import
---

=== from external package not allowed
from pandas import DataFrame
def f() -> object:
    return DataFrame()
---
error: import
---

=== import as alias not allowed
import sys as system
def f() -> list[str]:
    return system.argv
---
error: import
---

=== from import as alias allowed
from typing import Callable as Fn
def f(fn: Fn[[int], int]) -> int:
    return fn(1)
---
ok
---

=== star import not allowed
from typing import *
def f(x: Optional[int]) -> int:
    return x or 0
---
error: import
---

=== import inside function not allowed
def f() -> int:
    import sys
    return len(sys.argv)
---
error: import
---

=== no imports needed for builtins
def f(xs: list[int]) -> int:
    return len(xs)
---
ok
---
